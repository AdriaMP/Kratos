from __future__ import print_function, absolute_import, division
import KratosMultiphysics
import KratosMultiphysics.StructuralMechanicsApplication as StructuralMechanicsApplication
import KratosMultiphysics.KratosUnittest as KratosUnittest
import KratosMultiphysics.kratos_utilities as kratos_utilities
import RVEAnalysis


class TestRVESimplestTest(KratosUnittest.TestCase):

    def test_rve_computation_block_version(self):
        with open("rve_test/smallest_rve_test_parameters.json", 'r') as parameter_file:
            parameters = KratosMultiphysics.Parameters(parameter_file.read())

        parameters["solver_settings"]["block_builder"].SetBool(True)
        parameters["solver_settings"]["multi_point_constraints_used"].SetBool(True)

        self._aux_rve_computation(parameters)

    @KratosUnittest.skip("Reactions not 100% acurate")
    def test_rve_computation_elimination_version(self):
        with open("rve_test/smallest_rve_test_parameters.json", 'r') as parameter_file:
            parameters = KratosMultiphysics.Parameters(parameter_file.read())

        parameters["solver_settings"]["block_builder"].SetBool(False)
        parameters["solver_settings"]["multi_point_constraints_used"].SetBool(True)

        self._aux_rve_computation(parameters)

    def _aux_rve_computation(self, parameters):

        model = KratosMultiphysics.Model()
        simulation = RVEAnalysis.RVEAnalysis(model, parameters)
        simulation.Run()

        model_part = model["Structure.computing_domain"]
        ## Generate reference
        #counter = 0
        #for node in model_part.Nodes:
            #counter += 1
            #print("self.assertAlmostEqual(model_part.Nodes["+str(counter)+"].GetSolutionStepValue(KratosMultiphysics.REACTION_X), "+ str(node.GetSolutionStepValue(KratosMultiphysics.REACTION_X)) +", 5)")
            #print("self.assertAlmostEqual(model_part.Nodes["+str(counter)+"].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), "+ str(node.GetSolutionStepValue(KratosMultiphysics.REACTION_Y)) +", 5)")
            #print("self.assertAlmostEqual(model_part.Nodes["+str(counter)+"].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), "+ str(node.GetSolutionStepValue(KratosMultiphysics.REACTION_Z)) +", 5)")
            #print("self.assertAlmostEqual(model_part.Nodes["+str(counter)+"].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), "+ str(node.GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X)) +", 5)")
            #print("self.assertAlmostEqual(model_part.Nodes["+str(counter)+"].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), "+ str(node.GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y)) +", 5)")
            #print("self.assertAlmostEqual(model_part.Nodes["+str(counter)+"].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), "+ str(node.GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z)) +", 5)")

        # Compare reactions adn displacements
        self.assertAlmostEqual(model_part.Nodes[1].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.023695897701957035, 5)
        self.assertAlmostEqual(model_part.Nodes[1].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.008473448984120646, 5)
        self.assertAlmostEqual(model_part.Nodes[1].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.040123238485570346, 5)
        self.assertAlmostEqual(model_part.Nodes[1].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[1].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[1].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[2].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.07517503524601432, 5)
        self.assertAlmostEqual(model_part.Nodes[2].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.005727925951685647, 5)
        self.assertAlmostEqual(model_part.Nodes[2].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.07275117123228027, 5)
        self.assertAlmostEqual(model_part.Nodes[2].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[2].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[2].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[3].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.08913071195164371, 5)
        self.assertAlmostEqual(model_part.Nodes[3].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.010622521461896395, 5)
        self.assertAlmostEqual(model_part.Nodes[3].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.017015151025907845, 5)
        self.assertAlmostEqual(model_part.Nodes[3].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[3].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[3].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[4].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.012319279161751349, 5)
        self.assertAlmostEqual(model_part.Nodes[4].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.006337213703231547, 5)
        self.assertAlmostEqual(model_part.Nodes[4].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.14974429480655516, 5)
        self.assertAlmostEqual(model_part.Nodes[4].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[4].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[4].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[5].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.0241797065507403, 5)
        self.assertAlmostEqual(model_part.Nodes[5].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.002337672604104466, 5)
        self.assertAlmostEqual(model_part.Nodes[5].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.01958580697996824, 5)
        self.assertAlmostEqual(model_part.Nodes[5].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[5].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[5].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[6].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.006772127039984789, 5)
        self.assertAlmostEqual(model_part.Nodes[6].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.0074304614284934015, 5)
        self.assertAlmostEqual(model_part.Nodes[6].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.1133001455989798, 5)
        self.assertAlmostEqual(model_part.Nodes[6].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[6].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[6].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[7].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.0285162745822992, 5)
        self.assertAlmostEqual(model_part.Nodes[7].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.0016750346216750807, 5)
        self.assertAlmostEqual(model_part.Nodes[7].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.018060034088599883, 5)
        self.assertAlmostEqual(model_part.Nodes[7].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[7].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[7].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[8].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.15153516492613275, 5)
        self.assertAlmostEqual(model_part.Nodes[8].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.013052004153162223, 5)
        self.assertAlmostEqual(model_part.Nodes[8].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.010780765304809075, 5)
        self.assertAlmostEqual(model_part.Nodes[8].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[8].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[8].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[9].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 9.454242944073599e-17, 5)
        self.assertAlmostEqual(model_part.Nodes[9].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -1.0083080204115191e-17, 5)
        self.assertAlmostEqual(model_part.Nodes[9].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 3.469446951953614e-17, 5)
        self.assertAlmostEqual(model_part.Nodes[9].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[9].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[9].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[10].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.1253484601859278, 5)
        self.assertAlmostEqual(model_part.Nodes[10].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.0008621285477914617, 5)
        self.assertAlmostEqual(model_part.Nodes[10].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.012930073133637641, 5)
        self.assertAlmostEqual(model_part.Nodes[10].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[10].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[10].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[11].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.11325922438550073, 5)
        self.assertAlmostEqual(model_part.Nodes[11].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.003059279030169956, 5)
        self.assertAlmostEqual(model_part.Nodes[11].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.08732603705109815, 5)
        self.assertAlmostEqual(model_part.Nodes[11].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[11].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[11].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[12].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.08336460851516296, 5)
        self.assertAlmostEqual(model_part.Nodes[12].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.01431497237619762, 5)
        self.assertAlmostEqual(model_part.Nodes[12].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.0015034969874893993, 5)
        self.assertAlmostEqual(model_part.Nodes[12].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[12].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[12].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[13].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.03696773365687589, 5)
        self.assertAlmostEqual(model_part.Nodes[13].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.010611129864988238, 5)
        self.assertAlmostEqual(model_part.Nodes[13].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.04490274601740346, 5)
        self.assertAlmostEqual(model_part.Nodes[13].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[13].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[13].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[14].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.018049610067640467, 5)
        self.assertAlmostEqual(model_part.Nodes[14].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.01927230115839082, 5)
        self.assertAlmostEqual(model_part.Nodes[14].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.03455449945227491, 5)
        self.assertAlmostEqual(model_part.Nodes[14].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[14].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[14].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[15].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.09159593657345749, 5)
        self.assertAlmostEqual(model_part.Nodes[15].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.025376472758752253, 5)
        self.assertAlmostEqual(model_part.Nodes[15].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.09732927031758824, 5)
        self.assertAlmostEqual(model_part.Nodes[15].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[15].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[15].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[16].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.12075176442039157, 5)
        self.assertAlmostEqual(model_part.Nodes[16].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.009231168716763207, 5)
        self.assertAlmostEqual(model_part.Nodes[16].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.012000589730696166, 5)
        self.assertAlmostEqual(model_part.Nodes[16].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[16].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[16].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[17].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.02803941196211296, 5)
        self.assertAlmostEqual(model_part.Nodes[17].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.02356097063076138, 5)
        self.assertAlmostEqual(model_part.Nodes[17].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.00674967403324395, 5)
        self.assertAlmostEqual(model_part.Nodes[17].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[17].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[17].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[18].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.0018244364188662208, 5)
        self.assertAlmostEqual(model_part.Nodes[18].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.003379049108096588, 5)
        self.assertAlmostEqual(model_part.Nodes[18].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.10131520004266303, 5)
        self.assertAlmostEqual(model_part.Nodes[18].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[18].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[18].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[19].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.16387100302700208, 5)
        self.assertAlmostEqual(model_part.Nodes[19].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.015248412549408497, 5)
        self.assertAlmostEqual(model_part.Nodes[19].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.07795332613329876, 5)
        self.assertAlmostEqual(model_part.Nodes[19].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[19].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[19].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[20].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.21671789940210576, 5)
        self.assertAlmostEqual(model_part.Nodes[20].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.0055165264949620756, 5)
        self.assertAlmostEqual(model_part.Nodes[20].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.031150876252554558, 5)
        self.assertAlmostEqual(model_part.Nodes[20].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[20].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[20].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[21].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.06037572257322002, 5)
        self.assertAlmostEqual(model_part.Nodes[21].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.012334169651243756, 5)
        self.assertAlmostEqual(model_part.Nodes[21].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.008560748478395296, 5)
        self.assertAlmostEqual(model_part.Nodes[21].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[21].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[21].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[22].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.037967651022022195, 5)
        self.assertAlmostEqual(model_part.Nodes[22].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.03556449353174292, 5)
        self.assertAlmostEqual(model_part.Nodes[22].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.058676414443648434, 5)
        self.assertAlmostEqual(model_part.Nodes[22].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[22].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[22].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[23].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.13911016089943415, 5)
        self.assertAlmostEqual(model_part.Nodes[23].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.00435469417535685, 5)
        self.assertAlmostEqual(model_part.Nodes[23].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.0026474189070078286, 5)
        self.assertAlmostEqual(model_part.Nodes[23].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[23].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[23].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[24].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.014794710790050217, 5)
        self.assertAlmostEqual(model_part.Nodes[24].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.004786549032134945, 5)
        self.assertAlmostEqual(model_part.Nodes[24].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.10422463373101559, 5)
        self.assertAlmostEqual(model_part.Nodes[24].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[24].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[24].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[25].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.07838398172867203, 5)
        self.assertAlmostEqual(model_part.Nodes[25].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.0043037583773608504, 5)
        self.assertAlmostEqual(model_part.Nodes[25].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.018240205688508704, 5)
        self.assertAlmostEqual(model_part.Nodes[25].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[25].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[25].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[26].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.06545998886057966, 5)
        self.assertAlmostEqual(model_part.Nodes[26].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.023085276377071504, 5)
        self.assertAlmostEqual(model_part.Nodes[26].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.09273246039654962, 5)
        self.assertAlmostEqual(model_part.Nodes[26].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[26].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[26].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[27].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.11690813270843747, 5)
        self.assertAlmostEqual(model_part.Nodes[27].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.002810290827326951, 5)
        self.assertAlmostEqual(model_part.Nodes[27].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.00723263648847745, 5)
        self.assertAlmostEqual(model_part.Nodes[27].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[27].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[27].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[28].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.035364486270035814, 5)
        self.assertAlmostEqual(model_part.Nodes[28].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.03547823801200971, 5)
        self.assertAlmostEqual(model_part.Nodes[28].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.13635131948910675, 5)
        self.assertAlmostEqual(model_part.Nodes[28].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[28].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[28].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[29].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.02242337730659665, 5)
        self.assertAlmostEqual(model_part.Nodes[29].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.006222837473406352, 5)
        self.assertAlmostEqual(model_part.Nodes[29].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.03901717471755442, 5)
        self.assertAlmostEqual(model_part.Nodes[29].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[29].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[29].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[30].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.0373950053644207, 5)
        self.assertAlmostEqual(model_part.Nodes[30].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.004535026914896632, 5)
        self.assertAlmostEqual(model_part.Nodes[30].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.008089185689597565, 5)
        self.assertAlmostEqual(model_part.Nodes[30].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[30].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[30].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[31].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.09915255375400914, 5)
        self.assertAlmostEqual(model_part.Nodes[31].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.013007549427361315, 5)
        self.assertAlmostEqual(model_part.Nodes[31].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.023221877822450256, 5)
        self.assertAlmostEqual(model_part.Nodes[31].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[31].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[31].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[32].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.08762374771901939, 5)
        self.assertAlmostEqual(model_part.Nodes[32].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.03087749998278381, 5)
        self.assertAlmostEqual(model_part.Nodes[32].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.15856173869161017, 5)
        self.assertAlmostEqual(model_part.Nodes[32].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[32].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[32].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[33].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.04349203309032314, 5)
        self.assertAlmostEqual(model_part.Nodes[33].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.03126289732800962, 5)
        self.assertAlmostEqual(model_part.Nodes[33].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.18338258217235714, 5)
        self.assertAlmostEqual(model_part.Nodes[33].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[33].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[33].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[34].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.016532045718046468, 5)
        self.assertAlmostEqual(model_part.Nodes[34].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.002931171940142291, 5)
        self.assertAlmostEqual(model_part.Nodes[34].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.21356265773207891, 5)
        self.assertAlmostEqual(model_part.Nodes[34].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[34].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[34].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[35].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.06155825795235636, 5)
        self.assertAlmostEqual(model_part.Nodes[35].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.01523947673165216, 5)
        self.assertAlmostEqual(model_part.Nodes[35].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.05983836037747105, 5)
        self.assertAlmostEqual(model_part.Nodes[35].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[35].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[35].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[36].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.10191092257280383, 5)
        self.assertAlmostEqual(model_part.Nodes[36].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.005279383049051354, 5)
        self.assertAlmostEqual(model_part.Nodes[36].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.02765280499313688, 5)
        self.assertAlmostEqual(model_part.Nodes[36].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[36].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[36].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[37].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.10598189220840942, 5)
        self.assertAlmostEqual(model_part.Nodes[37].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.04011579434296843, 5)
        self.assertAlmostEqual(model_part.Nodes[37].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.06077797457390651, 5)
        self.assertAlmostEqual(model_part.Nodes[37].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[37].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[37].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[38].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.12106337085993342, 5)
        self.assertAlmostEqual(model_part.Nodes[38].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.004471529069210337, 5)
        self.assertAlmostEqual(model_part.Nodes[38].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.0031019655453049487, 5)
        self.assertAlmostEqual(model_part.Nodes[38].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[38].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[38].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[39].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.0062293704211528154, 5)
        self.assertAlmostEqual(model_part.Nodes[39].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.027851125302893437, 5)
        self.assertAlmostEqual(model_part.Nodes[39].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.4049793094709759, 5)
        self.assertAlmostEqual(model_part.Nodes[39].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[39].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[39].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[40].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.030438101675324635, 5)
        self.assertAlmostEqual(model_part.Nodes[40].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.004465383431745962, 5)
        self.assertAlmostEqual(model_part.Nodes[40].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.003944955793761303, 5)
        self.assertAlmostEqual(model_part.Nodes[40].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[40].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[40].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[41].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.1658882882054905, 5)
        self.assertAlmostEqual(model_part.Nodes[41].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.03268188642873453, 5)
        self.assertAlmostEqual(model_part.Nodes[41].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.15638920203190343, 5)
        self.assertAlmostEqual(model_part.Nodes[41].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[41].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[41].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[42].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.0772434927656847, 5)
        self.assertAlmostEqual(model_part.Nodes[42].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.012181660870646965, 5)
        self.assertAlmostEqual(model_part.Nodes[42].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.012092241470641495, 5)
        self.assertAlmostEqual(model_part.Nodes[42].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[42].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[42].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[43].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.047949177429413216, 5)
        self.assertAlmostEqual(model_part.Nodes[43].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.05917935158445832, 5)
        self.assertAlmostEqual(model_part.Nodes[43].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.2682819619090047, 5)
        self.assertAlmostEqual(model_part.Nodes[43].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[43].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[43].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[44].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.03824025405223627, 5)
        self.assertAlmostEqual(model_part.Nodes[44].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.013450647529779303, 5)
        self.assertAlmostEqual(model_part.Nodes[44].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.04663343908795277, 5)
        self.assertAlmostEqual(model_part.Nodes[44].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[44].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[44].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[45].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.05269499526268044, 5)
        self.assertAlmostEqual(model_part.Nodes[45].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.010078143518478234, 5)
        self.assertAlmostEqual(model_part.Nodes[45].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.0014120122793757038, 5)
        self.assertAlmostEqual(model_part.Nodes[45].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[45].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[45].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[46].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.14578460519246972, 5)
        self.assertAlmostEqual(model_part.Nodes[46].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.026726841681468508, 5)
        self.assertAlmostEqual(model_part.Nodes[46].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.06155765094064935, 5)
        self.assertAlmostEqual(model_part.Nodes[46].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[46].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[46].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[47].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.11853989357473206, 5)
        self.assertAlmostEqual(model_part.Nodes[47].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.012800222449623793, 5)
        self.assertAlmostEqual(model_part.Nodes[47].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.19015642892966542, 5)
        self.assertAlmostEqual(model_part.Nodes[47].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[47].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[47].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[48].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.15615856857477567, 5)
        self.assertAlmostEqual(model_part.Nodes[48].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.06347406250925715, 5)
        self.assertAlmostEqual(model_part.Nodes[48].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.24628768041383378, 5)
        self.assertAlmostEqual(model_part.Nodes[48].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[48].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[48].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[49].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.1258561092838242, 5)
        self.assertAlmostEqual(model_part.Nodes[49].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.004710294289815706, 5)
        self.assertAlmostEqual(model_part.Nodes[49].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.018312242666401718, 5)
        self.assertAlmostEqual(model_part.Nodes[49].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[49].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[49].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[50].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.02216753725981889, 5)
        self.assertAlmostEqual(model_part.Nodes[50].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.0040790237290759535, 5)
        self.assertAlmostEqual(model_part.Nodes[50].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.006493400446678812, 5)
        self.assertAlmostEqual(model_part.Nodes[50].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[50].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[50].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[51].GetSolutionStepValue(KratosMultiphysics.REACTION_X), 0.0466327861480524, 5)
        self.assertAlmostEqual(model_part.Nodes[51].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), 0.011136573454127087, 5)
        self.assertAlmostEqual(model_part.Nodes[51].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), 0.2095577426729822, 5)
        self.assertAlmostEqual(model_part.Nodes[51].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[51].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[51].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[52].GetSolutionStepValue(KratosMultiphysics.REACTION_X), -0.058175507823803464, 5)
        self.assertAlmostEqual(model_part.Nodes[52].GetSolutionStepValue(KratosMultiphysics.REACTION_Y), -0.014297693453106698, 5)
        self.assertAlmostEqual(model_part.Nodes[52].GetSolutionStepValue(KratosMultiphysics.REACTION_Z), -0.001968238821790473, 5)
        self.assertAlmostEqual(model_part.Nodes[52].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_X), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[52].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Y), 0.0, 5)
        self.assertAlmostEqual(model_part.Nodes[52].GetSolutionStepValue(KratosMultiphysics.DISPLACEMENT_Z), 0.0, 5)

        Cestimated = model_part.GetValue(StructuralMechanicsApplication.ELASTICITY_TENSOR)

        Canalytic = KratosMultiphysics.Matrix(6, 6)
        Canalytic.fill(0.0)
        E = 1e6
        nu = 0.3
        l = E*nu/((1+nu)*(1-2*nu))
        G = E/(2.0*(1.0+nu))
        Canalytic[0, 0] = l+2*G
        Canalytic[0, 1] = l
        Canalytic[0, 2] = l

        Canalytic[1, 0] = l
        Canalytic[1, 1] = l+2*G
        Canalytic[1, 2] = l

        Canalytic[2, 0] = l
        Canalytic[2, 1] = l
        Canalytic[2, 2] = l+2*G

        Canalytic[3, 3] = G
        Canalytic[4, 4] = G
        Canalytic[5, 5] = G

        for i in range(0, Cestimated.Size1()):
            for j in range(0, Cestimated.Size2()):
                self.assertAlmostEqual(
                    abs(Cestimated[i, j] - Canalytic[i, j])/(l+2*G), 0.0, 5)

        if not parameters["rve_settings"]["print_rve_post"].GetBool():
            kratos_utilities.DeleteFileIfExisting("smallest_test.post.bin")
            kratos_utilities.DeleteFileIfExisting("rve_test.post.lst")
            kratos_utilities.DeleteFileIfExisting("rve_elasticity_tensor.txt")


if __name__ == '__main__':
    KratosMultiphysics.Logger.GetDefaultOutput().SetSeverity(KratosMultiphysics.Logger.Severity.WARNING)
    KratosUnittest.main()
