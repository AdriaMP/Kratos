//    |  /           |
//    ' /   __| _` | __|  _ \   __|
//    . \  |   (   | |   (   |\__ `
//   _|\_\_|  \__,_|\__|\___/ ____/
//                   Multi-Physics
//
//  License:         BSD License
//                   Kratos default license: kratos/license.txt
//
//  Main authors:    Joaquin Gonzalez-Usua
//
//

// System includes

#include <math.h>
// External includes

// Project includes
#include "utilities/openmp_utils.h"
#include "containers/model.h"
#include "includes/checks.h"
#include "utilities/variable_utils.h"

// Application includes
#include "swimming_DEM_application.h"
#include "casas_solution_body_force_process.h"
#include "swimming_dem_application_variables.h"

namespace Kratos
{

/* Public functions *******************************************************/
CasasSolutionBodyForceProcess::CasasSolutionBodyForceProcess(
    ModelPart& rModelPart,
    const double Period,
    const double Density,
    const double Viscosity,
    const double DeltaAlpha,
    const double Length,
    const double MaxSqueezeFraction)
    : Process(),
      mrModelPart(rModelPart)
{
    // Member variables initialization
    mPeriod     = Period;
    mDensity    = Density;
    mViscosity  = Viscosity;
    mDeltaAlpha = DeltaAlpha;
    mLength     = Length;
    mMaxSqueezeFraction = MaxSqueezeFraction;

}

CasasSolutionBodyForceProcess::CasasSolutionBodyForceProcess(
    ModelPart& rModelPart,
    Parameters& rParameters)
    : Process(),
      mrModelPart(rModelPart)
{
    // Check default settings
    this->CheckDefaultsAndProcessSettings(rParameters);
}

CasasSolutionBodyForceProcess::CasasSolutionBodyForceProcess(
    Model &rModel,
    Parameters &rParameters)
    : Process(),
      mrModelPart(rModel.GetModelPart(rParameters["model_part_name"].GetString()))
{
    // Check default settings
    this->CheckDefaultsAndProcessSettings(rParameters);

}


void CasasSolutionBodyForceProcess::CheckDefaultsAndProcessSettings(Parameters &rParameters)
{
    Parameters default_parameters( R"(
    {
                "model_part_name"          : "please_specify_model_part_name",
                "variable_name"            : "BODY_FORCE",
                "benchmark_name"           : "custom_body_force.vortex",
                "benchmark_parameters"     : {
                                                "velocity"    : 1.0,
                                                "length"      : 1.0,
                                                "viscosity"   : 0.1,
                                                "density"     : 1.0,
                                                "frequency"   : 1.0,
                                                "damping"     : 1.0,
                                                "alpha0"      : 0.7,
                                                "alpha_min"   : 0.5,
                                                "period"      : 0.1,
                                                "delta_alpha" : 0.25,
                                                "max_squeeze_fraction" : 0.5,
                                                "omega" : 5.0
                },
                "compute_nodal_error"      : true,
                "print_convergence_output" : false,
                "output_parameters"        : {}
    }  )" );

    rParameters.ValidateAndAssignDefaults(default_parameters);

    mPeriod      = rParameters["benchmark_parameters"]["period"].GetDouble();
    mDensity     = rParameters["benchmark_parameters"]["density"].GetDouble();
    mViscosity   = rParameters["benchmark_parameters"]["viscosity"].GetDouble();
    mDeltaAlpha  = rParameters["benchmark_parameters"]["delta_alpha"].GetDouble();
    mLength      = rParameters["benchmark_parameters"]["length"].GetDouble();
    mOmega       = rParameters["benchmark_parameters"]["omega"].GetDouble();
    mMaxSqueezeFraction = rParameters["benchmark_parameters"]["max_squeeze_fraction"].GetDouble();

}

void CasasSolutionBodyForceProcess::Execute()
{
    this->ExecuteInitialize();
    this->ExecuteInitializeSolutionStep();
}

void CasasSolutionBodyForceProcess::ExecuteInitialize()
{}

void CasasSolutionBodyForceProcess::ExecuteBeforeSolutionLoop() 
{
    this->SetInitialBodyForceAndPorosityField();
}

void CasasSolutionBodyForceProcess::ExecuteInitializeSolutionStep() 
{
    this->SetBodyForceAndPorosityField();
}

void CasasSolutionBodyForceProcess::ExecuteFinalizeSolutionStep() {}

/* Protected functions ****************************************************/

void CasasSolutionBodyForceProcess::SetInitialBodyForceAndPorosityField() {

    const double time = mrModelPart.GetProcessInfo()[TIME];
    const double delta_alpha = mDeltaAlpha;
    const double omega = mOmega;
    const double max_squeeze_fraction = mMaxSqueezeFraction;
    const double L = mLength;
    const double rho = mDensity;
    const double nu = mViscosity;

    const double squeeze_factor = 1 + max_squeeze_fraction * std::sin(omega * time);
    const double L_x1 = L/2 * squeeze_factor;
    const double L_x2 = L/2 / squeeze_factor;

    double u1, u2, du1dt, du2dt, alpha, dalphat, alpha1, alpha2, du11, du12, du111, du112, du121, du122, du21, du22, du211, du212, du221, du222;

    // Computation of the BodyForce and Porosity fields
    for (int i_node = 1; i_node <= static_cast<int>(mrModelPart.NumberOfNodes()); ++i_node){
        int it_node = i_node;
            
        const double x1 = mrModelPart.GetNode(it_node).X();
        const double x2 = mrModelPart.GetNode(it_node).Y();

        if (x1 <= (L + L_x1)/2 && x1 >= (L - L_x1)/2 && x2 <= (L + L_x2)/2 && x2 >= (L - L_x2)/2){
            
            u1 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4));
    
            u2 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4));
    
            du1dt = -100*M_PI*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::sin(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) - 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)) + 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du2dt = -100*M_PI*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::sin(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) - 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)) + 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            alpha =  1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4);
    
            dalphat = -4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) + 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) + 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2));
    
            alpha1 = -16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4);
    
            alpha2 = -16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) - 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4);

            du11 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x1*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4));

            du12 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);
    
            du111 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 200*std::pow(x1, 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow(x1, 2)*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 400*x1*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 400*x1*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 3200*delta_alpha*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*std::exp(-time)*std::cos(M_PI*time)/(std::pow(L, 4)*std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2));

            du112 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 100*std::pow(x1, 2)*(2*x1 - 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x1, 2)*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 200*x1*std::pow((1 - x1), 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x1*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du121 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 100*std::pow(x1, 2)*(2*x1 - 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x1, 2)*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 200*x1*std::pow((1 - x1), 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x1*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du122 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(2400*x2 - 1200)*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow(x1, 2)*std::pow((1 - x1), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 3200*delta_alpha*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::exp(-time)*std::cos(M_PI*time)/(std::pow(L, 4)*std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2));

            du21 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du22 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x2*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4));

            du211 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(1200 - 2400*x1)*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow(x2, 2)*std::pow((1 - x2), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 3200*delta_alpha*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*std::exp(-time)*std::cos(M_PI*time)/(std::pow(L, 4)*std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2));

            du212 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 200*x2*std::pow((1 - x2), 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x2*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du221 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 200*x2*std::pow((1 - x2), 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x2*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du222 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 200*std::pow(x2, 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow(x2, 2)*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 400*x2*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 400*x2*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 3200*delta_alpha*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::exp(-time)*std::cos(M_PI*time)/(std::pow(L, 4)*std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2));
        }else{
            
            u1 = 100.0*std::pow(x1,2)*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            u2 = 100.0*std::pow(x2,2)*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du1dt = -100.0*M_PI*std::pow(x1,2)*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::sin(M_PI*time) - 100.0*std::pow(x1,2)*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du2dt = -100.0*M_PI*std::pow(x2,2)*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::sin(M_PI*time) - 100.0*std::pow(x2,2)*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            alpha = 1.0;

            dalphat = 0.0;

            alpha1 = 0.0;

            alpha2 = 0.0;

            du11 = 100.0*std::pow(x1,2)*(2*x1 - 2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x1*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du12 = 100.0*std::pow(x1,2)*std::pow((1 - x1),2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du111 = 200.0*std::pow(x1,2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 400.0*x1*(2*x1 - 2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du112 = 100.0*std::pow(x1,2)*(2*x1 - 2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x1*std::pow((1 - x1),2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du121 = 100.0*std::pow(x1,2)*(2*x1 - 2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x1*std::pow((1 - x1),2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du122 = 100.0*std::pow(x1,2)*std::pow((1 - x1),2)*(2400*x2 - 1200)*std::exp(-time)*std::cos(M_PI*time);

            du21 = 100.0*std::pow(x2,2)*std::pow((1 - x2),2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du22 = 100.0*std::pow(x2,2)*(2*x2 - 2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x2*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du211 = 100.0*std::pow(x2,2)*std::pow((1 - x2),2)*(1200 - 2400*x1)*std::exp(-time)*std::cos(M_PI*time);

            du212 = 100.0*std::pow(x2,2)*(2*x2 - 2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x2*std::pow((1 - x2),2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du221 = 100.0*std::pow(x2,2)*(2*x2 - 2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x2*std::pow((1 - x2),2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du222 = 200.0*std::pow(x2,2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 400.0*x2*(2*x2 - 2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

        }

        const double convective1 = u1 * du11 + u2 * du12; 
        const double convective2 = u1 * du21 + u2 * du22;
            
        const double div_of_sym_grad1 = (1.0/2.0) * (2 * du111 + du212 + du122);
        const double div_of_sym_grad2 = (1.0/2.0) * (du121 + du211 + 2 * du222);

        const double grad_of_div1 = du111 + du221;
        const double grad_of_div2 = du112 + du222;

        const double press_grad1 = 0.0;
        const double press_grad2 = 0.0;

        const double body_force1 = du1dt + convective1 + 1.0/rho * press_grad1 - 2 * nu * div_of_sym_grad1 + (2.0/3.0) * nu * grad_of_div1;
        const double body_force2 = du2dt + convective2 + 1.0/rho * press_grad2 - 2 * nu * div_of_sym_grad2 + (2.0/3.0) * nu * grad_of_div2;

        const double mass_source = dalphat + u1 * alpha1 + u2 * alpha2 + alpha * (du11 + du22);

        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(MASS_SOURCE) = mass_source;

        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(VELOCITY_X) = u1;
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(VELOCITY_Y) = u2;

        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(FLUID_FRACTION)      = alpha;
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(FLUID_FRACTION_RATE) = dalphat;
            
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(FLUID_FRACTION_GRADIENT_X) = alpha1;
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(FLUID_FRACTION_GRADIENT_Y) = alpha2;

        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(BODY_FORCE_X) = body_force1;
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(BODY_FORCE_Y) = body_force2;

        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(EXACT_VELOCITY_X) = u1;
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(EXACT_VELOCITY_Y) = u2;
        }

}

void CasasSolutionBodyForceProcess::SetBodyForceAndPorosityField() {

    const double time = mrModelPart.GetProcessInfo()[TIME];
    const double delta_alpha = mDeltaAlpha;
    const double omega = mOmega;
    const double max_squeeze_fraction = mMaxSqueezeFraction;
    const double L = mLength;
    const double rho = mDensity;
    const double nu = mViscosity;

    const double squeeze_factor = 1 + max_squeeze_fraction * std::sin(omega * time);
    const double L_x1 = L/2 * squeeze_factor;
    const double L_x2 = L/2 / squeeze_factor;

    double u1, u2, du1dt, du2dt, alpha, dalphat, alpha1, alpha2, du11, du12, du111, du112, du121, du122, du21, du22, du211, du212, du221, du222;

    // Computation of the BodyForce and Porosity fields
    for (int i_node = 1; i_node <= static_cast<int>(mrModelPart.NumberOfNodes()); ++i_node){
        int it_node = i_node;
            
        const double x1 = mrModelPart.GetNode(it_node).X();
        const double x2 = mrModelPart.GetNode(it_node).Y();
            
        if (x1 <= (L + L_x1)/2 && x1 >= (L - L_x1)/2 && x2 <= (L + L_x2)/2 && x2 >= (L - L_x2)/2){
            
            u1 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4));
    
            u2 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4));
    
            du1dt = -100*M_PI*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::sin(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) - 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)) + 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du2dt = -100*M_PI*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::sin(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) - 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)) + 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            alpha =  1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4);
    
            dalphat = -4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) + 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/std::pow(L, 3) + 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2)) - 4*delta_alpha*max_squeeze_fraction*omega*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::cos(omega*time)/(std::pow(L, 3)*std::pow(max_squeeze_fraction*std::sin(omega*time) + 1, 2));
    
            alpha1 = -16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4);
    
            alpha2 = -16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) - 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4);

            du11 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x1*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4));

            du12 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);
    
            du111 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 200*std::pow(x1, 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow(x1, 2)*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 400*x1*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 400*x1*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 3200*delta_alpha*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*std::exp(-time)*std::cos(M_PI*time)/(std::pow(L, 4)*std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2));

            du112 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 100*std::pow(x1, 2)*(2*x1 - 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x1, 2)*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 200*x1*std::pow((1 - x1), 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x1*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du121 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 100*std::pow(x1, 2)*(2*x1 - 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x1, 2)*(2*x1 - 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 200*x1*std::pow((1 - x1), 2)*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x1*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du122 = 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(2400*x2 - 1200)*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow(x1, 2)*std::pow((1 - x1), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(200*std::pow(x2, 2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 3200*delta_alpha*std::pow(x1, 2)*std::pow((1 - x1), 2)*(100*std::pow(x2, 2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2), 2))*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::exp(-time)*std::cos(M_PI*time)/(std::pow(L, 4)*std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2));

            du21 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du22 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x2*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4));

            du211 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(1200 - 2400*x1)*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow(x2, 2)*std::pow((1 - x2), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 3200*delta_alpha*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*std::exp(-time)*std::cos(M_PI*time)/(std::pow(L, 4)*std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2));

            du212 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 200*x2*std::pow((1 - x2), 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x2*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du221 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 100*std::pow(x2, 2)*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 200*x2*std::pow((1 - x2), 2)*(-200*std::pow(x1, 2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*x2*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2);

            du222 = 100*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*(32*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 32*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4), 3) + 200*std::pow(x2, 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow(x2, 2)*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 400*x2*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4) + 16*delta_alpha*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4))*std::exp(-time)*std::cos(M_PI*time)/std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2) + 400*x2*(2*x2 - 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 200*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*std::exp(-time)*std::cos(M_PI*time)/(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4)) + 3200*delta_alpha*std::pow(x2, 2)*std::pow((1 - x2), 2)*(-100*std::pow(x1, 2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1), 2))*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*std::exp(-time)*std::cos(M_PI*time)/(std::pow(L, 4)*std::pow(1 - 16*delta_alpha*(-L/2 - L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L/2 + L/(4*(max_squeeze_fraction*std::sin(omega*time) + 1)) + x2)*(-L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)*(L*(max_squeeze_fraction*std::sin(omega*time) + 1)/4 - L/2 + x1)/std::pow(L, 4),2));
        }else{
            
            u1 = 100.0*std::pow(x1,2)*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            u2 = 100.0*std::pow(x2,2)*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du1dt = -100.0*M_PI*std::pow(x1,2)*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::sin(M_PI*time) - 100.0*std::pow(x1,2)*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du2dt = -100.0*M_PI*std::pow(x2,2)*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::sin(M_PI*time) - 100.0*std::pow(x2,2)*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            alpha = 1.0;

            dalphat = 0.0;

            alpha1 = 0.0;

            alpha2 = 0.0;

            du11 = 100.0*std::pow(x1,2)*(2*x1 - 2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x1*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du12 = 100.0*std::pow(x1,2)*std::pow((1 - x1),2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du111 = 200.0*std::pow(x1,2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 400.0*x1*(2*x1 - 2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*std::pow((1 - x1),2)*(100*std::pow(x2,2)*(2*x2 - 2) + 200*x2*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du112 = 100.0*std::pow(x1,2)*(2*x1 - 2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x1*std::pow((1 - x1),2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du121 = 100.0*std::pow(x1,2)*(2*x1 - 2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x1*std::pow((1 - x1),2)*(200*std::pow(x2,2) + 400*x2*(2*x2 - 2) + 200*std::pow((1 - x2),2))*std::exp(-time)*std::cos(M_PI*time);

            du122 = 100.0*std::pow(x1,2)*std::pow((1 - x1),2)*(2400*x2 - 1200)*std::exp(-time)*std::cos(M_PI*time);

            du21 = 100.0*std::pow(x2,2)*std::pow((1 - x2),2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du22 = 100.0*std::pow(x2,2)*(2*x2 - 2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x2*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du211 = 100.0*std::pow(x2,2)*std::pow((1 - x2),2)*(1200 - 2400*x1)*std::exp(-time)*std::cos(M_PI*time);

            du212 = 100.0*std::pow(x2,2)*(2*x2 - 2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x2*std::pow((1 - x2),2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du221 = 100.0*std::pow(x2,2)*(2*x2 - 2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*x2*std::pow((1 - x2),2)*(-200*std::pow(x1,2) - 400*x1*(2*x1 - 2) - 200*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

            du222 = 200.0*std::pow(x2,2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 400.0*x2*(2*x2 - 2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time) + 200.0*std::pow((1 - x2),2)*(-100*std::pow(x1,2)*(2*x1 - 2) - 200*x1*std::pow((1 - x1),2))*std::exp(-time)*std::cos(M_PI*time);

        }

        const double convective1 = u1 * du11 + u2 * du12; 
        const double convective2 = u1 * du21 + u2 * du22;
            
        const double div_of_sym_grad1 = (1.0/2.0) * (2 * du111 + du212 + du122);
        const double div_of_sym_grad2 = (1.0/2.0) * (du121 + du211 + 2 * du222);

        const double grad_of_div1 = du111 + du221;
        const double grad_of_div2 = du112 + du222;

        const double press_grad1 = 0.0;
        const double press_grad2 = 0.0;

        const double body_force1 = du1dt + convective1 + 1.0/rho * press_grad1 - 2 * nu * div_of_sym_grad1 + (2.0/3.0) * nu * grad_of_div1;
        const double body_force2 = du2dt + convective2 + 1.0/rho * press_grad2 - 2 * nu * div_of_sym_grad2 + (2.0/3.0) * nu * grad_of_div2;

        const double mass_source = dalphat + u1 * alpha1 + u2 * alpha2 + alpha * (du11 + du22);

        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(MASS_SOURCE) = mass_source;
            
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(FLUID_FRACTION) = alpha;
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(FLUID_FRACTION_RATE) = dalphat;
            
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(FLUID_FRACTION_GRADIENT_X) = alpha1;
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(FLUID_FRACTION_GRADIENT_Y) = alpha2;

        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(BODY_FORCE_X) = body_force1;
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(BODY_FORCE_Y) = body_force2;

        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(EXACT_VELOCITY_X) = u1;
        mrModelPart.GetNode(it_node).FastGetSolutionStepValue(EXACT_VELOCITY_Y) = u2;
        }

}



/* Private functions ****************************************************/

};  // namespace Kratos.
